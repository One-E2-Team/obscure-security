<html>
    <head>
        <title>Login</title>
        <style>
            .container { 
            position: relative; 
            }
            .center {
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
            }
            input, select {
                margin: 1em;
                width: 150px;
                margin-left: 10px;
            }
        </style>
        <script>
            async function login(){
                let xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        sessionStorage.setItem("JWT", JSON.stringify(JSON.parse(this.response)));
                        window.location.href = '/certificates.html'
                    }
                };
                xhttp.open("POST", "/api/auth/login", true);
                xhttp.setRequestHeader("Content-type", "application/json");
                let encoder = new TextEncoder();
                let hash = await window.crypto.subtle.digest('SHA-512', encoder.encode(document.getElementById("password").value));
                let hexPass = (Array.from(new Uint8Array(hash))).map(b => b.toString(16).padStart(2, '0')).join('');
                let data = {email: document.getElementById("username").value, password: hexPass};
                xhttp.send(JSON.stringify(data));
            }
        </script>
    </head>
    <body>
        <div class="container center">
            <table>
                <tr>
                    <td><label for="username">Username: </label></td>
                    <td><input id = "username" type="text" name="username"/></td>
                </tr>
                <tr>
                    <td><label for="password">Password: </label></td>
                    <td><input type="password" name="password" id="password"/></td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center;"><input type="button" onclick="login()" value="login" /></td>
                </tr>
            </table>
            
        </div>
    </body>
    
</html>